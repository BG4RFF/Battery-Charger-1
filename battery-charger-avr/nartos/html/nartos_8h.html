<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Nartos AVR Operating SYstem: nartos.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>nartos.h File Reference</h1>
<p>
This graph shows which files directly or indirectly include this file:<p><center><img src="nartos_8h__dep__incl.png" border="0" usemap="#nartos.hdep_map" alt=""></center>
<map name="nartos.hdep_map">
<area href="nartos_8c.html" shape="rect" coords="133,5,211,32" alt="">
</map>

<p>
<a href="nartos_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="nartos_8h.html#5c0df4beb288dac07d8a97eebd7dd097">queueLength</a>&nbsp;&nbsp;&nbsp;8</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="nartos_8h.html#140c1bce9babd24ef980790f4acb7d28">taskRelinquish</a> (void) __attribute__((naked))</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Voluntary relinquishment of a task.  <a href="#140c1bce9babd24ef980790f4acb7d28"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="nartos_8h.html#253ce72f9cd199a9259695160a5e9398">taskExit</a> (void) __attribute__((naked))</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Exit a task.  <a href="#253ce72f9cd199a9259695160a5e9398"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="nartos_8h.html#c6cf6c67871bde9f47abdd8879c55500">taskWait</a> (void) __attribute__((naked))</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enter a wait state.  <a href="#c6cf6c67871bde9f47abdd8879c55500"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="nartos_8h.html#11212df27c38c27f13d6b352048750ca">nartos</a> (void) __attribute__((naked))</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Operating System Entry POint.  <a href="#11212df27c38c27f13d6b352048750ca"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="nartos_8h.html#8c0b6c3014b2baa19ca4c152f73b59d2">initNartos</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clear the task table and the queue pointers.  <a href="#8c0b6c3014b2baa19ca4c152f73b59d2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="nartos_8h.html#3393a493a2b83fda8be6de1bf179fc70">taskStart</a> (const uint16_t, const uint8_t)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Start a new task.  <a href="#3393a493a2b83fda8be6de1bf179fc70"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="nartos_8h.html#84299998f808c63f12f0fcacb406ef34">taskSchedule</a> (const uint8_t, const uint8_t)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Reschedule a suspended task.  <a href="#84299998f808c63f12f0fcacb406ef34"></a><br></td></tr>
</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="5c0df4beb288dac07d8a97eebd7dd097"></a><!-- doxytag: member="nartos.h::queueLength" ref="5c0df4beb288dac07d8a97eebd7dd097" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define queueLength&nbsp;&nbsp;&nbsp;8          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="nartos_8h-source.html#l00068">68</a> of file <a class="el" href="nartos_8h-source.html">nartos.h</a>.
<p>
Referenced by <a class="el" href="nartos_8c-source.html#l00078">initNartos()</a>, <a class="el" href="nartos_8c-source.html#l00237">nartos()</a>, <a class="el" href="nartos_8c-source.html#l00197">taskSchedule()</a>, and <a class="el" href="nartos_8c-source.html#l00103">taskStart()</a>.
</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="8c0b6c3014b2baa19ca4c152f73b59d2"></a><!-- doxytag: member="nartos.h::initNartos" ref="8c0b6c3014b2baa19ca4c152f73b59d2" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initNartos           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Clear the task table and the queue pointers. 
<p>

<p>
Definition at line <a class="el" href="nartos_8c-source.html#l00078">78</a> of file <a class="el" href="nartos_8c-source.html">nartos.c</a>.
<p>
References <a class="el" href="nartos_8h-source.html#l00068">queueLength</a>, <a class="el" href="nartos_8c-source.html#l00066">taskBufferOutPointer</a>, <a class="el" href="nartos_8c-source.html#l00067">taskBufferSize</a>, and <a class="el" href="nartos_8c-source.html#l00072">taskTable</a>.
</div>
</div><p>
<a class="anchor" name="11212df27c38c27f13d6b352048750ca"></a><!-- doxytag: member="nartos.h::nartos" ref="11212df27c38c27f13d6b352048750ca" args="(void) __attribute__((naked))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nartos           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Operating System Entry POint. 
<p>
This is the entry to the OS. This should never be called except at the end of the main program that launches one or more tasks.<p>
The stack is popped to discard the next execution address. If the queue is empty, there is nothing but to wait for something, maybe an ISR to reschedule a task. Normally the main program will have already started one or more tasks to get things ticking over.<p>
Get the next ID waiting, find its address from the task table and push it onto the queue to allow a jump to the address that was stored when this function exits. Refer to the introduction for information about the mechanics of the priority queue. 
<p>
Definition at line <a class="el" href="nartos_8c-source.html#l00237">237</a> of file <a class="el" href="nartos_8c-source.html">nartos.c</a>.
<p>
References <a class="el" href="nartos_8c-source.html#l00073">currentTaskID</a>, <a class="el" href="nartos_8h-source.html#l00068">queueLength</a>, <a class="el" href="nartos_8c-source.html#l00071">taskBuffer</a>, <a class="el" href="nartos_8c-source.html#l00066">taskBufferOutPointer</a>, <a class="el" href="nartos_8c-source.html#l00067">taskBufferSize</a>, and <a class="el" href="nartos_8c-source.html#l00072">taskTable</a>.
<p>
Referenced by <a class="el" href="nartos_8c-source.html#l00153">taskExit()</a>, <a class="el" href="nartos_8c-source.html#l00133">taskRelinquish()</a>, and <a class="el" href="nartos_8c-source.html#l00170">taskWait()</a>.
</div>
</div><p>
<a class="anchor" name="253ce72f9cd199a9259695160a5e9398"></a><!-- doxytag: member="nartos.h::taskExit" ref="253ce72f9cd199a9259695160a5e9398" args="(void) __attribute__((naked))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void taskExit           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Exit a task. 
<p>
Pop the stack to discard the next execution address, and quit. This results in the task execution being terminated. 
<p>
Definition at line <a class="el" href="nartos_8c-source.html#l00153">153</a> of file <a class="el" href="nartos_8c-source.html">nartos.c</a>.
<p>
References <a class="el" href="nartos_8c-source.html#l00073">currentTaskID</a>, <a class="el" href="nartos_8c-source.html#l00237">nartos()</a>, and <a class="el" href="nartos_8c-source.html#l00072">taskTable</a>.
</div>
</div><p>
<a class="anchor" name="140c1bce9babd24ef980790f4acb7d28"></a><!-- doxytag: member="nartos.h::taskRelinquish" ref="140c1bce9babd24ef980790f4acb7d28" args="(void) __attribute__((naked))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void taskRelinquish           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Voluntary relinquishment of a task. 
<p>
Get the task's next execution address off the stack and place it in the task table at the place reserved for the task. Schedule the task on the queue for execution at the next opportune moment. 
<p>
Definition at line <a class="el" href="nartos_8c-source.html#l00133">133</a> of file <a class="el" href="nartos_8c-source.html">nartos.c</a>.
<p>
References <a class="el" href="nartos_8c-source.html#l00073">currentTaskID</a>, <a class="el" href="nartos_8c-source.html#l00062">FALSE</a>, <a class="el" href="nartos_8c-source.html#l00237">nartos()</a>, <a class="el" href="nartos_8c-source.html#l00197">taskSchedule()</a>, and <a class="el" href="nartos_8c-source.html#l00072">taskTable</a>.
</div>
</div><p>
<a class="anchor" name="84299998f808c63f12f0fcacb406ef34"></a><!-- doxytag: member="nartos.h::taskSchedule" ref="84299998f808c63f12f0fcacb406ef34" args="(const uint8_t, const uint8_t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void taskSchedule           </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&nbsp;</td>
          <td class="paramname"> <em>taskID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&nbsp;</td>
          <td class="paramname"> <em>isr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Reschedule a suspended task. 
<p>
This reschedules a task on the queue for execution at an opportune time. If the buffer is filled, then the schedule does not take place. Refer to the introduction for information about the mechanics of the priority queue.<ul>
<li>taskBufferSize is the total number of tasks waiting in the queue.</li><li>taskBufferPrioritySize is the number of priority tasks waiting.</li><li>taskBufferInPointer indicates the next free location</li><li>taskBufferOutPointer indicates the next ID to access. Specify isr=TRUE if this is done in an ISR to avoid prematurely enabling interrupts. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>taskID</em>&nbsp;</td><td>The identifier of the task being rescheduled. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>isr</em>&nbsp;</td><td>A boolean to indicate if we are being called in an ISR. </td></tr>
  </table>
</dl>
</li></ul>

<p>
Definition at line <a class="el" href="nartos_8c-source.html#l00197">197</a> of file <a class="el" href="nartos_8c-source.html">nartos.c</a>.
<p>
References <a class="el" href="nartos_8h-source.html#l00068">queueLength</a>, <a class="el" href="nartos_8c-source.html#l00071">taskBuffer</a>, <a class="el" href="nartos_8c-source.html#l00066">taskBufferOutPointer</a>, and <a class="el" href="nartos_8c-source.html#l00067">taskBufferSize</a>.
<p>
Referenced by <a class="el" href="nartos_8c-source.html#l00133">taskRelinquish()</a>, and <a class="el" href="nartos_8c-source.html#l00103">taskStart()</a>.
</div>
</div><p>
<a class="anchor" name="3393a493a2b83fda8be6de1bf179fc70"></a><!-- doxytag: member="nartos.h::taskStart" ref="3393a493a2b83fda8be6de1bf179fc70" args="(const uint16_t, const uint8_t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t taskStart           </td>
          <td>(</td>
          <td class="paramtype">const uint16_t&nbsp;</td>
          <td class="paramname"> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&nbsp;</td>
          <td class="paramname"> <em>isr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Start a new task. 
<p>
Places the task address in the task table in an empty spot, and schedules its ID on the queue. Specify isr=TRUE if this is done in an ISR, so that interrupts are not prematurely enabled. If the task table fills, then the task is simply not scheduled. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>address</em>&nbsp;</td><td>The address pointer of the task start point. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>isr</em>&nbsp;</td><td>A boolean to indicate if we are being called in an ISR. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The index into the task table. </dd></dl>

<p>
Definition at line <a class="el" href="nartos_8c-source.html#l00103">103</a> of file <a class="el" href="nartos_8c-source.html">nartos.c</a>.
<p>
References <a class="el" href="nartos_8h-source.html#l00068">queueLength</a>, <a class="el" href="nartos_8c-source.html#l00197">taskSchedule()</a>, and <a class="el" href="nartos_8c-source.html#l00072">taskTable</a>.
</div>
</div><p>
<a class="anchor" name="c6cf6c67871bde9f47abdd8879c55500"></a><!-- doxytag: member="nartos.h::taskWait" ref="c6cf6c67871bde9f47abdd8879c55500" args="(void) __attribute__((naked))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void taskWait           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Enter a wait state. 
<p>
Pull the task next execution address off the stack and place it in the task table at the designated spot. The task is not rescheduled. Another task must do this at some stage else the task remains indefinitely suspended. 
<p>
Definition at line <a class="el" href="nartos_8c-source.html#l00170">170</a> of file <a class="el" href="nartos_8c-source.html">nartos.c</a>.
<p>
References <a class="el" href="nartos_8c-source.html#l00073">currentTaskID</a>, <a class="el" href="nartos_8c-source.html#l00237">nartos()</a>, and <a class="el" href="nartos_8c-source.html#l00072">taskTable</a>.
</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Tue Sep 4 14:04:10 2007 for Nartos AVR Operating SYstem by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
